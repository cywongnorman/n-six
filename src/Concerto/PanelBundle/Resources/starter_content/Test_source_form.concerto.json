{
    "version": "5.0.beta.5.3",
    "collection": [
        {
            "class_name": "Test",
            "id": 7,
            "name": "source_form",
            "accessibility": 2,
            "archived": "0",
            "visibility": 2,
            "type": 0,
            "code": "if(is.null(template_def) || is.na(template_def) || template_def == \"\") {\n  decoded_template_def = fromJSON(concerto.var.get(\"template_def\"))\n} else {\n  decoded_template_def = fromJSON(template_def)\n}\n\nisValid = function(type, value, condition, form, response) {\n  valid = T\n  if(!is.null(response)) {\n    env_vld = new.env()\n    if(length(form) > 0) {\n      for(i in 1:length(form)) {\n        v = response[[form[[i]]$name]]\n        assign(form[[i]]$name, v, envir=env_vld)\n      }\n    }\n\n    res = try(eval(parse(text=condition), envir=env_vld), T)\n    if(!is.null(res) && res == T) {\n      valid = T\n    }\n    if(!is.null(res) && res == F) {\n      valid = F\n    }\n  }\n  return(valid)\n}\n\ngetContent = function(paragraph, form, response) {\n  content = paragraph\n  if(length(form) > 0) {\n    for(i in 1:length(form)) {\n      type = form[[i]]$definition$type\n      value = response[[form[[i]]$name]]\n      if(is.null(value)) {\n        value = form[[i]]$default\n      }\n      if(is.null(value)) {\n        value = \"\"\n      }\n      condition = form[[i]]$validation\n      valid = isValid(type, value, condition, form, response)\n      id = paste0(\"form\",i)\n      name = form[[i]]$name\n      label = form[[i]]$label\n      control = \"\"\n\n      if(type == \"custom\") {\n        control = concerto.template.join(templateId=form[[i]]$definition$custom_template,params=list(id=id,name=name,value=value)) \n      } else if(type == \"singleline\") {\n        control = concerto.template.join(templateId=form_field_input_template,params=list(id=id,name=name,type=\"text\",value=value))\n      } else if(type == \"password\") {\n        control = concerto.template.join(templateId=form_field_input_template,params=list(id=id,name=name,type=\"password\",value=value))\n      } else if(type == \"date\") {\n        control = concerto.template.join(templateId=form_field_input_template,params=list(id=id,name=name,type=\"date\",value=value))\n      } else if(type == \"multiline\") {\n        control = concerto.template.join(templateId=form_field_multiline_template,params=list(id=id,name=name,value=value))\n      } else if(type == \"file\") {\n        control = concerto.template.join(templateId=form_field_file_template,params=list(id=id,name=name))\n      } else if(type == \"select\") {\n        control = concerto.template.join(templateId=form_field_select_template,params=list(id=id,name=name,options=toJSON(form[[i]]$definition$select_options),value=value))\n      } else if(type == \"checkbox\") {\n        checked = \"\"\n        if(value==\"1\") {\n          checked = \"checked\"\n        }\n        control = concerto.template.join(templateId=form_field_checkbox_template,params=list(id=id,name=name,attrs=checked))\n      } else if(type == \"slider\") {\n        if(value == \"\") {\n          value = \"null\";\n        }\n        control = concerto.template.join(templateId=form_field_slider_template,params=list(id=id,name=name,value=value,definition=toJSON(form[[i]]$definition)))\n      }\n        classes = \"\"\n        if(!is.null(response) && !valid) {\n          classes = \"validationHighlight\"\n        }\n        field = concerto.template.join(templateId=form_field_template,params=list(id=id,label=label,classes=classes,control=control))\n        content = paste0(content, field)\n        }\n        }\n        return(content)\n        }\n\n        getAlert = function(form, response) {\n          alert = NULL\n          if(response$buttonPressed != \"submit\") {\n            return(alert)\n          }\n\n          if(length(form) > 0) {\n            for(i in 1:length(form)) {\n              type = form[[i]]$definition$type\n              value = response[[form[[i]]$name]]\n              condition = form[[i]]$validation\n              valid = isValid(type, value, condition, form, response)\n\n              validationHighlight = \"\"\n              if(!is.null(response) && !valid) {\n                alert = paste0(alert,concerto.template.join(templateId=form_alert_template,params=list(alert=form[[i]]$alert)))\n              }\n            }\n          }\n          return(alert)\n        }\n\n        getTemplateParams = function(template_params){\n          params = list()\n          if(!is.null(inserts) && is.list(inserts)) {\n            params = inserts\n          }\n          for(key in ls(template_params)) {\n            params[[key]] = template_params[[key]]\n          }\n          return(params)\n        }\n\n        cb1 = fromJSON(custom_button_1)\n        buttons = concerto.template.join(templateId=buttons_template,params=list(\n          label=button_label,\n          cb1_enabled=cb1$enabled,\n          cb1_label=cb1$label\n        ))\n\n        content = paragraph\n        form = fromJSON(form)\n\n        if(!is.null(warning_msg) && (is.na(warning_msg) || warning_msg == \"\")) {\n          warning_msg = \"\"\n        }\n\n        response = NULL\n        while(T) {\n          content = getContent(paragraph, form, response)\n          response = concerto.template.show(decoded_template_def$layout, params=getTemplateParams(list(\n            header=decoded_template_def$header, \n            title=title,\n            content=content, \n            warning_msg=warning_msg, \n            buttons=buttons,\n            footer=decoded_template_def$footer\n          )))\n          warning_msg = getAlert(form, response)\n          if(is.null(warning_msg) || warning_msg == \"\") { break }\n        }\n\n        if(response$buttonPressed == \"submit\") {\n          .branch = \"submit\"\n        } else if(response$buttonPressed == \"custom_button_1\") {\n          .branch = \"custom_button_1\"\n        }",
            "outdated": "0",
            "description": "",
            "variables": [
                {
                    "class_name": "TestVariable",
                    "id": 117,
                    "name": "submit",
                    "type": 2,
                    "description": "",
                    "passableThroughUrl": "0",
                    "value": "0",
                    "test": 7,
                    "parentVariable": null
                },
                {
                    "class_name": "TestVariable",
                    "id": 118,
                    "name": "form",
                    "type": 0,
                    "description": "",
                    "passableThroughUrl": "0",
                    "value": null,
                    "test": 7,
                    "parentVariable": null
                },
                {
                    "class_name": "TestVariable",
                    "id": 119,
                    "name": "button_label",
                    "type": 0,
                    "description": "",
                    "passableThroughUrl": "0",
                    "value": null,
                    "test": 7,
                    "parentVariable": null
                },
                {
                    "class_name": "TestVariable",
                    "id": 120,
                    "name": "paragraph",
                    "type": 0,
                    "description": "",
                    "passableThroughUrl": "0",
                    "value": null,
                    "test": 7,
                    "parentVariable": null
                },
                {
                    "class_name": "TestVariable",
                    "id": 121,
                    "name": "response",
                    "type": 1,
                    "description": "<p><span style=\"line-height: 20.8px;\">Submitted user response R list object<\/span><\/p>",
                    "passableThroughUrl": "0",
                    "value": null,
                    "test": 7,
                    "parentVariable": null
                },
                {
                    "class_name": "TestVariable",
                    "id": 122,
                    "name": "inserts",
                    "type": 0,
                    "description": "",
                    "passableThroughUrl": "0",
                    "value": null,
                    "test": 7,
                    "parentVariable": null
                },
                {
                    "class_name": "TestVariable",
                    "id": 123,
                    "name": "warning_msg",
                    "type": 0,
                    "description": "",
                    "passableThroughUrl": "0",
                    "value": null,
                    "test": 7,
                    "parentVariable": null
                },
                {
                    "class_name": "TestVariable",
                    "id": 124,
                    "name": "title",
                    "type": 0,
                    "description": "",
                    "passableThroughUrl": "0",
                    "value": null,
                    "test": 7,
                    "parentVariable": null
                },
                {
                    "class_name": "TestVariable",
                    "id": 125,
                    "name": "template_def",
                    "type": 0,
                    "description": "",
                    "passableThroughUrl": "0",
                    "value": null,
                    "test": 7,
                    "parentVariable": null
                },
                {
                    "class_name": "TestVariable",
                    "id": 126,
                    "name": "form_field_template",
                    "type": 0,
                    "description": "",
                    "passableThroughUrl": "0",
                    "value": null,
                    "test": 7,
                    "parentVariable": null
                },
                {
                    "class_name": "TestVariable",
                    "id": 127,
                    "name": "form_field_input_template",
                    "type": 0,
                    "description": "",
                    "passableThroughUrl": "0",
                    "value": null,
                    "test": 7,
                    "parentVariable": null
                },
                {
                    "class_name": "TestVariable",
                    "id": 128,
                    "name": "form_field_multiline_template",
                    "type": 0,
                    "description": "",
                    "passableThroughUrl": "0",
                    "value": null,
                    "test": 7,
                    "parentVariable": null
                },
                {
                    "class_name": "TestVariable",
                    "id": 129,
                    "name": "form_field_select_template",
                    "type": 0,
                    "description": "",
                    "passableThroughUrl": "0",
                    "value": null,
                    "test": 7,
                    "parentVariable": null
                },
                {
                    "class_name": "TestVariable",
                    "id": 130,
                    "name": "form_field_checkbox_template",
                    "type": 0,
                    "description": "",
                    "passableThroughUrl": "0",
                    "value": null,
                    "test": 7,
                    "parentVariable": null
                },
                {
                    "class_name": "TestVariable",
                    "id": 131,
                    "name": "form_field_slider_template",
                    "type": 0,
                    "description": "",
                    "passableThroughUrl": "0",
                    "value": null,
                    "test": 7,
                    "parentVariable": null
                },
                {
                    "class_name": "TestVariable",
                    "id": 132,
                    "name": "form_alert_template",
                    "type": 0,
                    "description": "",
                    "passableThroughUrl": "0",
                    "value": null,
                    "test": 7,
                    "parentVariable": null
                },
                {
                    "class_name": "TestVariable",
                    "id": 133,
                    "name": "buttons_template",
                    "type": 0,
                    "description": "",
                    "passableThroughUrl": "0",
                    "value": null,
                    "test": 7,
                    "parentVariable": null
                },
                {
                    "class_name": "TestVariable",
                    "id": 134,
                    "name": "form_field_file_template",
                    "type": 0,
                    "description": "",
                    "passableThroughUrl": "0",
                    "value": null,
                    "test": 7,
                    "parentVariable": null
                },
                {
                    "class_name": "TestVariable",
                    "id": 135,
                    "name": "custom_button_1",
                    "type": 0,
                    "description": "",
                    "passableThroughUrl": "0",
                    "value": null,
                    "test": 7,
                    "parentVariable": null
                },
                {
                    "class_name": "TestVariable",
                    "id": 136,
                    "name": "custom_button_1",
                    "type": 2,
                    "description": "",
                    "passableThroughUrl": "0",
                    "value": null,
                    "test": 7,
                    "parentVariable": null
                },
                {
                    "class_name": "TestVariable",
                    "id": 137,
                    "name": ".branch",
                    "type": 1,
                    "description": "",
                    "passableThroughUrl": "0",
                    "value": null,
                    "test": 7,
                    "parentVariable": null
                }
            ],
            "sourceWizard": null,
            "sourceWizardName": null,
            "sourceWizardTest": null,
            "sourceWizardTestName": null,
            "updatedOn": "2018-05-16 18:17:08",
            "updatedBy": "",
            "nodes": [],
            "nodesConnections": [],
            "tags": "",
            "owner": 1,
            "groups": "",
            "starterContent": true,
            "hash": "1b8ddf8bfc517984bb9923275f93d4b48500bc38"
        }
    ]
}